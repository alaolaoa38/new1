<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Звездный Кликер</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Russo+One&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --neon-glow: 0 0 15px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 165, 0, 0.6);
            --header-height: 60px;
            --footer-height: 70px;
            --gold: #FFD700;
            --dark-purple: #1a1a3a;
            --tg-theme-bg-color: var(--dark-purple);
            --tg-theme-text-color: white;
            --tg-theme-hint-color: rgba(255, 255, 255, 0.6);
            --tg-theme-link-color: #5ac8fb;
            --tg-theme-button-color: #5ac8fb;
            --tg-theme-button-text-color: white;
            --tg-theme-secondary-bg-color: #2d1b4e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            overflow: hidden;
            position: relative;
            cursor: default;
        }

        /* Контейнер для центрирования контента */
        .container {
            width: 100%;
            height: calc(100vh - var(--header-height) - var(--footer-height));
            padding: 0 15px;
            margin: 0 auto;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        @media (min-width: 768px) {
            .container {
                max-width: 750px;
            }
        }

        @media (min-width: 992px) {
            .container {
                max-width: 970px;
            }
        }

        @media (min-width: 1200px) {
            .container {
                max-width: 1024px;
            }
        }

        /* Анимированные звезды на фоне */
        .star {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            pointer-events: none;
            animation: float linear infinite;
            z-index: 0;
            filter: blur(0.5px);
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) translateX(0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-20px) translateX(calc(var(--move-x) * 100px)) rotate(360deg);
                opacity: 0;
            }
        }

        /* Эффект при клике */
        .click-effect {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, rgba(255,215,0,0.8) 0%, rgba(255,215,0,0) 70%);
            border-radius: 50%;
            pointer-events: none;
            transform: scale(0);
            z-index: 1;
            filter: blur(1px);
        }

        @keyframes clickEffect {
            0% { transform: scale(0); opacity: 1; }
            70% { opacity: 0.7; }
            100% { transform: scale(15); opacity: 0; }
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Шапка */
        .header {
            height: var(--header-height);
            background: var(--tg-theme-secondary-bg-color);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 100;
            flex-shrink: 0;
            width: 100%;
            position: fixed;
            top: 0;
            padding: 0 15px;
        }
        
        .profile-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .profile-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(45deg, #FF8C00, #FFD700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            overflow: hidden;
            background-size: cover;
            background-position: center;
        }
        
        .profile-name {
            font-weight: 600;
            font-size: 14px;
            color: var(--tg-theme-text-color);
        }
        
        .balance-header {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 6px 12px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 4px;
            cursor: pointer;
            transition: all 0.3s;
            height: 36px;
            font-size: 14px;
            color: var(--tg-theme-text-color);
        }
        
        .balance-header:hover {
            background: rgba(255, 255, 255, 0.25);
        }
        
        /* Основной контент */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            margin-top: var(--header-height);
            margin-bottom: var(--footer-height);
            position: relative;
            background: var(--tg-theme-bg-color);
        }
        
        .section {
            display: none;
            width: 100%;
            max-width: 100%;
            animation: fadeIn 0.3s;
            flex-direction: column;
            align-items: center;
            padding: 15px 0;
            color: var(--tg-theme-text-color);
        }
        
        .section.active {
            display: flex;
        }
        
        /* Стили для кликера */
        .clicker-section {
            text-align: center;
        }
        
        .clicker-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            margin: 15px 0;
            position: relative;
            width: 100%;
        }
        
        h1 {
            font-family: 'Russo One', sans-serif;
            font-weight: 400;
            font-size: 28px;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(255, 255, 255, 0.3);
            letter-spacing: 1px;
            color: var(--gold);
            text-align: center;
            width: 100%;
        }

        @media (min-width: 768px) {
            h1 {
                font-size: 32px;
            }
        }
        
        .balance-display {
            font-size: 22px;
            font-weight: 700;
            margin: 10px 0 20px;
            display: flex;
            align-items: center;
            gap: 6px;
            justify-content: center;
            color: var(--tg-theme-text-color);
        }
        
        .clicker-btn {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,215,0,0.2) 0%, rgba(255,215,0,0) 70%);
            border: 4px solid rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            margin-bottom: 15px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.2);
        }

        @media (min-width: 768px) {
            .clicker-btn {
                width: 200px;
                height: 200px;
            }
        }
        
        .clicker-btn::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%);
            animation: pulseGlow 2s infinite alternate;
        }
        
        .clicker-btn:active {
            transform: scale(0.95);
            background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, rgba(255,215,0,0.1) 70%);
        }
        
        .star-icon {
            font-size: 70px;
            color: var(--gold);
            text-shadow: var(--neon-glow);
            animation: pulse 2s infinite alternate;
            user-select: none;
            position: relative;
            z-index: 2;
        }

        @media (min-width: 768px) {
            .star-icon {
                font-size: 90px;
            }
        }
        
        @keyframes pulse {
            from { transform: scale(1); opacity: 0.9; }
            to { transform: scale(1.05); opacity: 1; }
        }
        
        @keyframes pulseGlow {
            from { transform: scale(0.9); opacity: 0.5; }
            to { transform: scale(1.1); opacity: 0.8; }
        }
        
        .click-info {
            margin-top: 10px;
            font-size: 14px;
            opacity: 0.9;
            text-align: center;
            color: var(--tg-theme-text-color);
        }

        @media (min-width: 768px) {
            .click-info {
                font-size: 16px;
            }
        }
        
        /* Стили для бустов */
        .boost-card {
            background: var(--tg-theme-secondary-bg-color);
            border-radius: 12px;
            padding: 15px;
            margin: 8px 0;
            width: 100%;
            max-width: 350px;
            border-left: 4px solid var(--gold);
        }
        
        .boost-title {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--gold);
        }
        
        .boost-price {
            font-size: 16px;
            font-weight: 600;
            margin: 8px 0;
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--tg-theme-text-color);
        }
        
        .boost-desc {
            font-size: 13px;
            opacity: 0.8;
            margin-bottom: 12px;
            color: var(--tg-theme-hint-color);
        }
        
        .boost-btn {
            background: linear-gradient(45deg, #9C27B0, #E91E63);
            border: none;
            border-radius: 50px;
            padding: 10px 15px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .boost-btn:disabled {
            background: #555;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 12px 0;
            width: 100%;
        }
        
        /* Стили для друзей */
        .friends-section {
            width: 100%;
            max-width: 400px;
        }
        
        .friends-header {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            color: var(--gold);
        }
        
        .referral-card {
            background: var(--tg-theme-secondary-bg-color);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            width: 100%;
        }
        
        .referral-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
            text-align: center;
            color: var(--tg-theme-text-color);
        }
        
        .referral-reward {
            font-size: 15px;
            margin-bottom: 15px;
            text-align: center;
            color: var(--gold);
        }
        
        .invite-btn {
            background: linear-gradient(45deg, #00BCD4, #3F51B5);
            border: none;
            border-radius: 50px;
            padding: 10px 15px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 12px 0;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .referral-stats {
            font-weight: 600;
            text-align: center;
            margin-top: 12px;
            font-size: 14px;
            color: var(--tg-theme-text-color);
        }
        
        /* Стили для профиля */
        .profile-info-container {
            background: var(--tg-theme-secondary-bg-color);
            border-radius: 12px;
            padding: 15px;
            width: 100%;
            max-width: 350px;
        }
        
        .profile-row {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 6px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
        }
        
        .profile-label {
            opacity: 0.8;
            color: var(--tg-theme-hint-color);
        }
        
        .profile-value {
            font-weight: 600;
            color: var(--tg-theme-text-color);
        }
        
        .withdraw-btn-profile {
            background: linear-gradient(45deg, #FF8C00, #FFD700);
            border: none;
            border-radius: 50px;
            padding: 10px 15px;
            color: var(--dark-purple);
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 12px;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        /* Подвал с меню */
        .footer {
            height: var(--footer-height);
            background: var(--tg-theme-secondary-bg-color);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 100;
            flex-shrink: 0;
            width: 100%;
            position: fixed;
            bottom: 0;
        }
        
        .menu-container {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 100%;
            padding: 0 10px;
        }
        
        .menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--tg-theme-text-color);
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
            opacity: 0.7;
            flex: 1;
            height: 100%;
            padding: 8px 5px;
        }
        
        .menu-item i {
            font-size: 20px;
            margin-bottom: 3px;
            display: inline-block;
        }
        
        .menu-item.active {
            opacity: 1;
            color: var(--gold);
            transform: translateY(-3px);
        }

        @media (min-width: 768px) {
            .menu-item {
                font-size: 12px;
            }
            
            .menu-item i {
                font-size: 22px;
            }
        }
        
        /* Модальные окна */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 200;
            align-items: center;
            justify-content: center;
            padding: 15px;
        }
        
        .modal-content {
            background: var(--tg-theme-secondary-bg-color);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            max-width: 400px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
            color: var(--tg-theme-text-color);
        }
        
        .modal-title {
            font-family: 'Russo One', sans-serif;
            font-size: 22px;
            margin-bottom: 15px;
            color: var(--gold);
            text-align: center;
        }
        
        .withdraw-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .withdraw-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            padding: 10px;
            color: var(--tg-theme-text-color);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
            font-size: 14px;
        }
        
        .withdraw-btn span {
            display: block;
            font-size: 16px;
            color: var(--gold);
            margin-top: 3px;
        }
        
        .close-modal {
            background: linear-gradient(45deg, #9C27B0, #E91E63);
            border: none;
            border-radius: 50px;
            padding: 10px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .referral-link {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 12px;
            margin: 12px 0;
            word-break: break-all;
            font-size: 13px;
            color: var(--tg-theme-text-color);
        }
        
        .copy-btn {
            background: linear-gradient(45deg, #00BCD4, #3F51B5);
            border: none;
            border-radius: 50px;
            padding: 10px 15px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        /* Кастомное уведомление */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--tg-theme-secondary-bg-color);
            color: var(--tg-theme-text-color);
            padding: 12px 20px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 300;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.3s, fadeOut 0.3s 2s forwards;
            border: 1px solid rgba(255, 215, 0, 0.3);
            font-size: 14px;
            max-width: 90%;
        }

        @media (min-width: 768px) {
            .notification {
                font-size: 16px;
            }
        }

        .notification i {
            color: var(--gold);
        }

        @keyframes slideIn {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; visibility: hidden; }
        }

        /* Окно без звезд */
        .no-coins {
            text-align: center;
            padding: 15px;
        }

        .no-coins-icon {
            font-size: 40px;
            color: rgba(255, 215, 0, 0.5);
            margin-bottom: 10px;
        }

        .no-coins-text {
            margin-bottom: 15px;
            font-size: 14px;
            color: var(--tg-theme-text-color);
        }
        
        /* Прелоадер */
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--tg-theme-bg-color);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }

        .preloader-content {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .loader {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 215, 0, 0.3);
            border-radius: 50%;
            border-top-color: var(--gold);
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }

        .loader-text {
            font-family: 'Russo One', sans-serif;
            font-size: 22px;
            color: var(--gold);
            margin-bottom: 8px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .loader-subtext {
            font-size: 14px;
            color: var(--tg-theme-hint-color);
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Шапка -->
    <div class="header">
        <div class="profile-info">
            <div class="profile-avatar" id="profile-avatar">
                <i class="fas fa-user" id="avatar-fallback"></i>
            </div>
            <div class="profile-name" id="header-username">Игрок</div>
        </div>
        <div class="balance-header" id="balance-btn">
            <span id="header-balance">14.8</span> ⭐
        </div>
    </div>

    <!-- Прелоадер -->
    <div class="preloader" id="preloader">
        <div class="preloader-content">
            <div class="loader"></div>
            <h2 class="loader-text">Звездный Кликер</h2>
            <p class="loader-subtext">Загрузка...</p>
        </div>
    </div>
    
    <!-- Основной контент -->
    <div class="main-content" id="main-content">
        <div class="container">
            <!-- Кликер -->
            <div class="section active" id="clicker-section">
                <h1>ЗВЕЗДНЫЙ КЛИКЕР</h1>
                
                <div class="balance-display">
                    <span id="coins">14.8</span> ⭐
                </div>
                
                <div class="clicker-container">
                    <div class="clicker-btn" id="clicker-btn">
                        <div class="star-icon">⭐</div>
                    </div>
                    <div class="click-info">
                        +0.1 ⭐ за клик<br>
                        <span id="boost-info">Без буста</span>
                    </div>
                </div>
            </div>
            
            <!-- Бусты -->
            <div class="section" id="boosts-section">
                <h1>БУСТЫ</h1>
                
                <div class="boost-card">
                    <div class="boost-title">2X МНОЖИТЕЛЬ</div>
                    <div class="boost-price">50 ⭐</div>
                    <div class="boost-desc">Увеличивает доход от кликов</div>
                    <button class="boost-btn" data-price="50" data-multiplier="2">КУПИТЬ</button>
                </div>
                
                <div class="divider"></div>
                
                <div class="boost-card">
                    <div class="boost-title">3X МНОЖИТЕЛЬ</div>
                    <div class="boost-price">100 ⭐</div>
                    <div class="boost-desc">Увеличивает доход от кликов</div>
                    <button class="boost-btn" data-price="100" data-multiplier="3">КУПИТЬ</button>
                </div>
                
                <div class="divider"></div>
                
                <div class="boost-card">
                    <div class="boost-title">5X МНОЖИТЕЛЬ</div>
                    <div class="boost-price">200 ⭐</div>
                    <div class="boost-desc">Увеличивает доход от кликов</div>
                    <button class="boost-btn" data-price="200" data-multiplier="5">КУПИТЬ</button>
                </div>
            </div>
            
            <!-- Друзья -->
            <div class="section" id="friends-section">
                <h1>ДРУЗЬЯ</h1>
                
                <div class="referral-card">
                    <div class="referral-title">Приглашай друзей - Получай Награды!</div>
                    <div class="referral-reward">Каждый приглашенный друг = +10 ⭐</div>
                    
                    <button class="invite-btn" id="invite-btn">Пригласить друга</button>
                    
                    <div class="referral-stats">Приглашенные друзья: <span id="referral-count">0</span></div>
                </div>
            </div>
            
            <!-- Профиль -->
            <div class="section" id="profile-section">
                <h1>ПРОФИЛЬ</h1>
                
                <div class="profile-info-container">
                    <div class="profile-row">
                        <span class="profile-label">ID:</span>
                        <span class="profile-value" id="profile-id">123456</span>
                    </div>
                    <div class="profile-row">
                        <span class="profile-label">Никнейм:</span>
                        <span class="profile-value" id="profile-username">Игрок</span>
                    </div>
                    <div class="profile-row">
                        <span class="profile-label">Звезд:</span>
                        <span class="profile-value" id="profile-coins">14.8 ⭐</span>
                    </div>
                    <div class="profile-row">
                        <span class="profile-label">Буст:</span>
                        <span class="profile-value" id="profile-boost">Нет</span>
                    </div>
                    <div class="profile-row">
                        <span class="profile-label">Приглашено:</span>
                        <span class="profile-value" id="profile-referrals">0</span>
                    </div>
                    
                    <button class="withdraw-btn-profile" id="profile-withdraw-btn">
                        Вывести звезды
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Подвал с меню -->
    <div class="footer">
        <div class="menu-container">
            <div class="menu-item active" data-section="clicker-section">
                <i class="fas fa-star"></i>
                <span>Кликер</span>
            </div>
            <div class="menu-item" data-section="boosts-section">
                <i class="fas fa-bolt"></i>
                <span>Бусты</span>
            </div>
            <div class="menu-item" data-section="friends-section">
                <i class="fas fa-users"></i>
                <span>Друзья</span>
            </div>
            <div class="menu-item" data-section="profile-section">
                <i class="fas fa-user"></i>
                <span>Профиль</span>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно вывода -->
    <div class="modal" id="withdraw-modal">
        <div class="modal-content">
            <div class="modal-title">ВЫВОД ЗВЕЗД</div>
            <div id="withdraw-content">
                <div class="withdraw-options">
                    <button class="withdraw-btn" data-amount="50">50 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="100">100 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="250">250 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="500">500 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="1000">1000 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="2500">2500 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="5000">5000 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="10000">10000 <span>⭐</span></button>
                </div>
                <button class="close-modal" id="close-modal">ЗАКРЫТЬ</button>
            </div>
            <div id="no-coins-content" style="display: none;">
                <div class="no-coins">
                    <div class="no-coins-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="no-coins-text">
                        У вас недостаточно звезд для вывода
                    </div>
                    <button class="close-modal" id="close-no-coins-modal">ЗАКРЫТЬ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно реферальной ссылки -->
    <div class="modal" id="referral-modal">
        <div class="modal-content">
            <div class="modal-title">Пригласить друга</div>
            <div class="referral-link" id="referral-link-text">https://example.com?ref=123456</div>
            <button class="copy-btn" id="copy-btn">СКОПИРОВАТЬ ССЫЛКУ</button>
            <button class="close-modal" id="close-referral-modal">ЗАКРЫТЬ</button>
        </div>
    </div>

    <script>
        // Инициализация Telegram WebApp
        const tg = window.Telegram.WebApp;
        
        // Данные пользователя
        const userData = {
            id: tg.initDataUnsafe.user?.id || 'user_' + Math.floor(Math.random() * 1000000).toString(),
            username: tg.initDataUnsafe.user?.username || 'Игрок',
            firstName: tg.initDataUnsafe.user?.first_name || 'Игрок',
            lastName: tg.initDataUnsafe.user?.last_name || '',
            photoUrl: tg.initDataUnsafe.user?.photo_url || '',
            coins: parseFloat(localStorage.getItem('starCoins')) || 14.8,
            boostMultiplier: 1,
            activeBoost: null,
            boostEndTime: 0,
            referrals: parseInt(localStorage.getItem('referralsCount')) || 0,
            referralCode: localStorage.getItem('referralCode') || generateReferralCode()
        };

        // Генерация реферального кода
        function generateReferralCode() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let result = '';
            for (let i = 0; i < 6; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            localStorage.setItem('referralCode', result);
            return result;
        }

        // Установка аватарки пользователя
        function setUserAvatar() {
            const avatarElement = document.getElementById('profile-avatar');
            const fallbackIcon = document.getElementById('avatar-fallback');
            
            if (userData.photoUrl) {
                avatarElement.style.backgroundImage = `url(${userData.photoUrl})`;
                fallbackIcon.style.display = 'none';
            } else {
                avatarElement.style.backgroundImage = '';
                fallbackIcon.style.display = 'flex';
            }
        }

        // Создание звезд на фоне
        function createStars() {
            const starCount = 50;
            
            // Удаляем старые звезды
            document.querySelectorAll('.star').forEach(star => star.remove());
            
            // Создаем новые звезды
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                const size = Math.random() * 3 + 1;
                const posX = Math.random() * 100;
                const duration = Math.random() * 15 + 10;
                const delay = Math.random() * 5;
                const opacity = Math.random() * 0.5 + 0.3;
                const moveX = Math.random() * 2 - 1;
                
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${posX}vw`;
                star.style.bottom = '0';
                star.style.animationDuration = `${duration}s`;
                star.style.animationDelay = `${delay}s`;
                star.style.opacity = opacity;
                star.style.setProperty('--move-x', moveX);
                
                document.body.appendChild(star);
            }
        }

        // Эффект при клике на фон
        function setupBackgroundClickEffect() {
            const mainContent = document.getElementById('main-content');
            
            mainContent.addEventListener('click', function(e) {
                if (e.target === mainContent) {
                    createClickEffect(e.clientX, e.clientY);
                }
            });
        }

        function createClickEffect(x, y) {
            const clickEffect = document.createElement('div');
            clickEffect.className = 'click-effect';
            clickEffect.style.left = `${x - 5}px`;
            clickEffect.style.top = `${y - 5}px`;
            
            document.body.appendChild(clickEffect);
            
            setTimeout(() => {
                clickEffect.style.animation = 'clickEffect 0.6s ease-out forwards';
                setTimeout(() => clickEffect.remove(), 600);
            }, 10);
        }

        // Показ кастомного уведомления
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.remove(), 2300);
        }

        // Элементы
        const clickerBtn = document.getElementById('clicker-btn');
        const coinsDisplay = document.getElementById('coins');
        const headerBalance = document.getElementById('header-balance');
        const headerUsername = document.getElementById('header-username');
        const balanceBtn = document.getElementById('balance-btn');
        const boostInfo = document.getElementById('boost-info');
        const profileId = document.getElementById('profile-id');
        const profileUsername = document.getElementById('profile-username');
        const profileCoins = document.getElementById('profile-coins');
        const profileBoost = document.getElementById('profile-boost');
        const profileReferrals = document.getElementById('profile-referrals');
        const inviteBtn = document.getElementById('invite-btn');
        const boostButtons = document.querySelectorAll('.boost-btn');
        const withdrawModal = document.getElementById('withdraw-modal');
        const closeModal = document.getElementById('close-modal');
        const withdrawBtns = document.querySelectorAll('.withdraw-btn');
        const menuItems = document.querySelectorAll('.menu-item');
        const sections = document.querySelectorAll('.section');
        const profileWithdrawBtn = document.getElementById('profile-withdraw-btn');
        const preloader = document.getElementById('preloader');
        const referralModal = document.getElementById('referral-modal');
        const referralLinkText = document.getElementById('referral-link-text');
        const copyBtn = document.getElementById('copy-btn');
        const closeReferralModal = document.getElementById('close-referral-modal');
        const referralCount = document.getElementById('referral-count');
        const withdrawContent = document.getElementById('withdraw-content');
        const noCoinsContent = document.getElementById('no-coins-content');
        const closeNoCoinsModal = document.getElementById('close-no-coins-modal');

        // Инициализация
        function init() {
            // Настройка Telegram WebApp
            tg.expand();
            tg.enableClosingConfirmation();
            
            // Установка темы Telegram
            document.body.style.backgroundColor = tg.themeParams.bg_color || 'var(--tg-theme-bg-color)';
            
            // Установка данных пользователя
            const displayName = userData.username || `${userData.firstName}${userData.lastName ? ' ' + userData.lastName : ''}`;
            headerUsername.textContent = displayName;
            profileUsername.textContent = displayName;
            profileId.textContent = userData.id;
            setUserAvatar();
            
            createStars();
            setupBackgroundClickEffect();
            
            // Обновляем звезды каждые 30 секунд
            setInterval(createStars, 30000);
            
            withdrawModal.style.display = 'none';
            referralModal.style.display = 'none';
            
            profileReferrals.textContent = userData.referrals;
            referralCount.textContent = userData.referrals;
            updateBalance();
            checkActiveBoost();
            
            // Клик по звезде
            clickerBtn.addEventListener('click', () => {
                clickerBtn.style.transform = 'scale(0.95)';
                setTimeout(() => clickerBtn.style.transform = 'scale(1)', 100);
                
                userData.coins += 0.1 * userData.boostMultiplier;
                updateBalance();
                localStorage.setItem('starCoins', userData.coins);
                
                const rect = clickerBtn.getBoundingClientRect();
                createClickEffect(rect.left + rect.width/2, rect.top + rect.height/2);
            });
            
            // Клик по балансу
            balanceBtn.addEventListener('click', () => {
                withdrawModal.style.display = 'flex';
                
                if (userData.coins >= 50) {
                    withdrawContent.style.display = 'block';
                    noCoinsContent.style.display = 'none';
                } else {
                    withdrawContent.style.display = 'none';
                    noCoinsContent.style.display = 'block';
                }
            });
            
            // Закрытие модальных окон
            closeModal.addEventListener('click', () => withdrawModal.style.display = 'none');
            closeNoCoinsModal.addEventListener('click', () => withdrawModal.style.display = 'none');
            closeReferralModal.addEventListener('click', () => referralModal.style.display = 'none');
            
            // Кнопки вывода
            withdrawBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const amount = parseInt(this.getAttribute('data-amount'));
                    if (userData.coins >= amount) {
                        userData.coins -= amount;
                        updateBalance();
                        localStorage.setItem('starCoins', userData.coins);
                        showNotification(`Выведено ${amount} ⭐`);
                        withdrawModal.style.display = 'none';
                    } else {
                        withdrawContent.style.display = 'none';
                        noCoinsContent.style.display = 'block';
                    }
                });
            });
            
            // Покупка бустов
            boostButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const price = parseInt(this.getAttribute('data-price'));
                    const multiplier = parseInt(this.getAttribute('data-multiplier'));
                    
                    if (userData.coins >= price) {
                        userData.coins -= price;
                        userData.boostMultiplier = multiplier;
                        userData.boostEndTime = Date.now() + 30000;
                        
                        updateBalance();
                        updateBoostInfo();
                        this.disabled = true;
                        this.textContent = 'АКТИВЕН';
                        this.style.background = 'linear-gradient(45deg, #4CAF50, #8BC34A)';
                        
                        setTimeout(() => {
                            if (userData.boostMultiplier === multiplier) {
                                userData.boostMultiplier = 1;
                                updateBoostInfo();
                            }
                            this.disabled = false;
                            this.textContent = 'КУПИТЬ';
                            this.style.background = 'linear-gradient(45deg, #9C27B0, #E91E63)';
                        }, 30000);
                        
                        localStorage.setItem('starCoins', userData.coins);
                    } else {
                        showNotification('Недостаточно звезд!');
                    }
                });
            });
            
            // Скрытие прелоадера
            setTimeout(() => {
                preloader.style.opacity = '0';
                preloader.style.visibility = 'hidden';
            }, 2000);
            
            // Вывод в профиле
            profileWithdrawBtn.addEventListener('click', function() {
                withdrawModal.style.display = 'flex';
                
                if (userData.coins >= 50) {
                    withdrawContent.style.display = 'block';
                    noCoinsContent.style.display = 'none';
                } else {
                    withdrawContent.style.display = 'none';
                    noCoinsContent.style.display = 'block';
                }
            });
            
            // Приглашение друзей
            inviteBtn.addEventListener('click', () => {
                referralLinkText.textContent = `https://t.me/${tg.initDataUnsafe.user?.username || 'your_bot'}?start=${userData.referralCode}`;
                referralModal.style.display = 'flex';
            });
            
            // Копирование ссылки
            copyBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(referralLinkText.textContent)
                    .then(() => {
                        showNotification('Ссылка скопирована!');
                        referralModal.style.display = 'none';
                    })
                    .catch(err => {
                        console.error('Ошибка копирования: ', err);
                        const textarea = document.createElement('textarea');
                        textarea.value = referralLinkText.textContent;
                        document.body.appendChild(textarea);
                        textarea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textarea);
                        showNotification('Ссылка скопирована!');
                        referralModal.style.display = 'none';
                    });
            });
            
            // Переключение разделов
            menuItems.forEach(item => {
                item.addEventListener('click', () => {
                    const sectionId = item.getAttribute('data-section');
                    
                    menuItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    sections.forEach(section => section.classList.remove('active'));
                    document.getElementById(sectionId).classList.add('active');
                });
            });
        }
        
        // Обновление баланса
        function updateBalance() {
            const coins = userData.coins.toFixed(1);
            coinsDisplay.textContent = coins;
            headerBalance.textContent = coins;
            profileCoins.textContent = coins + ' ⭐';
            localStorage.setItem('starCoins', userData.coins);
        }
        
        // Обновление информации о бусте
        function updateBoostInfo() {
            if (userData.boostMultiplier > 1) {
                const timeLeft = Math.ceil((userData.boostEndTime - Date.now()) / 1000);
                if (timeLeft > 0) {
                    boostInfo.textContent = `Буст x${userData.boostMultiplier} (${timeLeft} сек)`;
                    profileBoost.textContent = `x${userData.boostMultiplier} (активен)`;
                } else {
                    boostInfo.textContent = 'Без буста';
                    profileBoost.textContent = 'Нет';
                }
            } else {
                boostInfo.textContent = 'Без буста';
                profileBoost.textContent = 'Нет';
            }
        }
        
        // Проверка активного буста
        function checkActiveBoost() {
            if (userData.boostEndTime > Date.now()) {
                const timeLeft = Math.ceil((userData.boostEndTime - Date.now()) / 1000);
                boostInfo.textContent = `Буст x${userData.boostMultiplier} (${timeLeft} сек)`;
                
                const timer = setInterval(() => {
                    const timeLeft = Math.ceil((userData.boostEndTime - Date.now()) / 1000);
                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        userData.boostMultiplier = 1;
                        updateBoostInfo();
                        
                        boostButtons.forEach(btn => {
                            if (btn.disabled) {
                                btn.disabled = false;
                                btn.textContent = 'КУПИТЬ';
                                btn.style.background = 'linear-gradient(45deg, #9C27B0, #E91E63)';
                            }
                        });
                    } else {
                        boostInfo.textContent = `Буст x${userData.boostMultiplier} (${timeLeft} сек)`;
                    }
                }, 1000);
            } else {
                updateBoostInfo();
            }
        }
        
        // Запуск
        init();
    </script>
</body>
</html>
