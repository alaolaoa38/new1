<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Звездный Кликер</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Russo+One&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --neon-glow: 0 0 15px rgba(255, 215, 0, 0.8), 0 0 30px rgba(255, 165, 0, 0.6);
            --header-height: 70px;
            --footer-height: 80px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: linear-gradient(-45deg, #0f0524, #1a1a3a, #2d1b4e, #3a1b6e);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: white;
            overflow: hidden;
            position: relative;
            cursor: default;
        }

        /* Анимированные звезды на фоне */
        .star {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            pointer-events: none;
            animation: float linear infinite;
            z-index: 0;
            filter: blur(0.5px);
        }

        /* Большие звезды для глубокого фона */
        .star-bg {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            pointer-events: none;
            animation: rotate linear infinite;
            z-index: -1;
            filter: blur(0.8px);
        }

        /* Вращающиеся созвездия */
        .constellation {
            position: absolute;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            animation: rotate linear infinite reverse;
            z-index: -1;
        }

        .constellation::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, transparent 60%, rgba(255,215,0,0.02) 100%);
            border-radius: 50%;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-20px) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes rotate {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        /* Эффект при клике на фон */
        .click-effect {
            position: absolute;
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, rgba(255,215,0,0.8) 0%, rgba(255,215,0,0) 70%);
            border-radius: 50%;
            pointer-events: none;
            transform: scale(0);
            z-index: 1;
            filter: blur(1px);
        }

        /* Эффект пульсации для глубокого фона */
        .pulse-effect {
            position: absolute;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(255,215,0,0.02) 0%, transparent 70%);
            border-radius: 50%;
            pointer-events: none;
            animation: pulseEffect 8s ease infinite;
            z-index: -1;
            opacity: 0;
        }

        @keyframes clickEffect {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            70% {
                opacity: 0.7;
            }
            100% {
                transform: scale(15);
                opacity: 0;
            }
        }

        @keyframes pulseEffect {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }
            50% {
                opacity: 0.1;
            }
            100% {
                transform: scale(1.5);
                opacity: 0;
            }
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Шапка */
        .header {
            height: var(--header-height);
            background: rgba(20, 10, 40, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 100;
            flex-shrink: 0;
        }
        
        .profile-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .profile-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #FF8C00, #FFD700);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }
        
        .profile-name {
            font-weight: 600;
            font-size: 16px;
        }
        
        .balance-header {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 8px 16px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            transition: all 0.3s;
            height: 40px;
        }
        
        .balance-header:hover {
            background: rgba(255, 255, 255, 0.25);
        }
        
        /* Основной контент */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
            width: 100%;
        }
        
        .section {
            display: none;
            width: 100%;
            max-width: 400px;
            animation: fadeIn 0.3s;
            flex-direction: column;
            align-items: center;
        }
        
        .section.active {
            display: flex;
        }
        
        /* Стили для кликера */
        .clicker-section {
            text-align: center;
        }
        
        .clicker-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            margin: 20px 0;
            position: relative;
        }
        
        h1 {
            font-family: 'Russo One', sans-serif;
            font-weight: 400;
            font-size: 32px;
            margin-bottom: 15px;
            text-shadow: 0 2px 10px rgba(255, 255, 255, 0.3);
            letter-spacing: 1px;
            color: #FFD700;
            text-align: center;
            width: 100%;
        }
        
        .balance-display {
            font-size: 24px;
            font-weight: 700;
            margin: 10px 0 25px;
            display: flex;
            align-items: center;
            gap: 6px;
            justify-content: center;
        }
        
        .clicker-btn {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,215,0,0.2) 0%, rgba(255,215,0,0) 70%);
            border: 4px solid rgba(255, 215, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            margin-bottom: 20px;
        }
        
        .clicker-btn:active {
            transform: scale(0.95);
            background: radial-gradient(circle, rgba(255,215,0,0.3) 0%, rgba(255,215,0,0.1) 70%);
        }
        
        .star-icon {
            font-size: 90px;
            color: gold;
            text-shadow: var(--neon-glow);
            animation: pulse 2s infinite alternate;
            user-select: none;
        }
        
        @keyframes pulse {
            from { transform: scale(1); opacity: 0.9; }
            to { transform: scale(1.05); opacity: 1; }
        }
        
        .click-info {
            margin-top: 15px;
            font-size: 16px;
            opacity: 0.9;
            text-align: center;
        }
        
        /* Стили для бустов */
        .boost-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            width: 100%;
            max-width: 350px;
            border-left: 4px solid #FFD700;
        }
        
        .boost-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
            color: #FFD700;
        }
        
        .boost-price {
            font-size: 18px;
            font-weight: 600;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .boost-desc {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 15px;
        }
        
        .boost-btn {
            background: linear-gradient(45deg, #9C27B0, #E91E63);
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
        }
        
        .boost-btn:disabled {
            background: #555;
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
            margin: 15px 0;
            width: 100%;
        }
        
        /* Стили для друзей */
        .friends-section {
            width: 100%;
            max-width: 400px;
        }
        
        .friends-header {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            color: #FFD700;
        }
        
        .referral-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            width: 100%;
        }
        
        .referral-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .referral-reward {
            font-size: 16px;
            margin-bottom: 20px;
            text-align: center;
            color: #FFD700;
        }
        
        .invite-btn {
            background: linear-gradient(45deg, #00BCD4, #3F51B5);
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 15px 0;
            transition: all 0.3s;
        }
        
        .referral-stats {
            font-weight: 600;
            text-align: center;
            margin-top: 15px;
        }
        
        /* Стили для профиля */
        .profile-info-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            width: 100%;
            max-width: 350px;
        }
        
        .profile-row {
            display: flex;
            justify-content: space-between;
            margin: 12px 0;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .profile-label {
            opacity: 0.8;
        }
        
        .profile-value {
            font-weight: 600;
        }
        
        .withdraw-btn-profile {
            background: linear-gradient(45deg, #FF8C00, #FFD700);
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            color: #1a1a3a;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        /* Подвал */
        .footer {
            height: var(--footer-height);
            background: rgba(20, 10, 40, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 100;
            flex-shrink: 0;
        }
        
        .menu-container {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 500px;
            padding: 0 10px;
        }
        
        .menu-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
            opacity: 0.7;
            flex: 1;
            height: 100%;
            padding: 10px 5px;
        }
        
        .menu-item i {
            font-size: 22px;
            margin-bottom: 5px;
        }
        
        .menu-item.active {
            opacity: 1;
            color: #FFD700;
            transform: translateY(-5px);
        }
        
        /* Модальные окна */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            z-index: 200;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: rgba(30, 15, 60, 0.95);
            border-radius: 20px;
            padding: 25px;
            width: 90%;
            max-width: 400px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .modal-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
            z-index: -1;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .modal-title {
            font-family: 'Russo One', sans-serif;
            font-size: 24px;
            margin-bottom: 20px;
            color: #FFD700;
            text-align: center;
        }
        
        .withdraw-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .withdraw-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 10px;
            padding: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .withdraw-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, transparent, rgba(255,215,0,0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s;
        }
        
        .withdraw-btn:hover::before {
            transform: translateX(100%);
        }
        
        .withdraw-btn span {
            display: block;
            font-size: 18px;
            color: #FFD700;
            margin-top: 5px;
        }
        
        .close-modal {
            background: linear-gradient(45deg, #9C27B0, #E91E63);
            border: none;
            border-radius: 50px;
            padding: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(156, 39, 176, 0.4);
        }
        
        .referral-link {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            word-break: break-all;
            font-size: 14px;
        }
        
        .copy-btn {
            background: linear-gradient(45deg, #00BCD4, #3F51B5);
            border: none;
            border-radius: 50px;
            padding: 12px 20px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .copy-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 188, 212, 0.4);
        }
        
        /* Кастомное уведомление */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(30, 15, 60, 0.95);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 300;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s, fadeOut 0.3s 2s forwards;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .notification i {
            color: #FFD700;
        }

        @keyframes slideIn {
            from { top: -100px; opacity: 0; }
            to { top: 20px; opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; visibility: hidden; }
        }

        /* Окно без звезд */
        .no-coins {
            text-align: center;
            padding: 20px;
        }

        .no-coins-icon {
            font-size: 50px;
            color: rgba(255, 215, 0, 0.5);
            margin-bottom: 15px;
        }

        .no-coins-text {
            margin-bottom: 20px;
        }
        
        /* Прелоадер */
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(-45deg, #0f0524, #1a1a3a, #2d1b4e, #3a1b6e);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            flex-direction: column;
        }

        .preloader-content {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .loader {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 215, 0, 0.3);
            border-radius: 50%;
            border-top-color: #FFD700;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        .loader-text {
            font-family: 'Russo One', sans-serif;
            font-size: 24px;
            color: #FFD700;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }

        .loader-subtext {
            font-size: 16px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- Шапка -->
    <div class="header">
        <div class="profile-info">
            <div class="profile-avatar">
                <i class="fas fa-user"></i>
            </div>
            <div class="profile-name" id="header-username">Игрок</div>
        </div>
        <div class="balance-header" id="balance-btn">
            <span id="header-balance">0</span> ⭐
        </div>
    </div>

    <!-- Прелоадер -->
    <div class="preloader" id="preloader">
        <div class="preloader-content">
            <div class="loader"></div>
            <h2 class="loader-text">Звездный Кликер</h2>
            <p class="loader-subtext">Загрузка...</p>
        </div>
    </div>
    
    <!-- Основной контент -->
    <div class="main-content" id="main-content">
        <!-- Кликер -->
        <div class="section active" id="clicker-section">
            <h1>ЗВЕЗДНЫЙ КЛИКЕР</h1>
            
            <div class="balance-display">
                <span id="coins">0</span> ⭐
            </div>
            
            <div class="clicker-container">
                <div class="clicker-btn" id="clicker-btn">
                    <div class="star-icon">⭐</div>
                </div>
                <div class="click-info">
                    +0.1 ⭐ за клик<br>
                    <span id="boost-info">Без буста</span>
                </div>
            </div>
        </div>
        
        <!-- Бусты -->
        <div class="section" id="boosts-section">
            <h1>БУСТЫ</h1>
            
            <div class="boost-card">
                <div class="boost-title">2X МНОЖИТЕЛЬ</div>
                <div class="boost-price">50 ⭐</div>
                <div class="boost-desc">Увеличивает доход от кликов</div>
                <button class="boost-btn" data-price="50" data-multiplier="2">КУПИТЬ</button>
            </div>
            
            <div class="divider"></div>
            
            <div class="boost-card">
                <div class="boost-title">3X МНОЖИТЕЛЬ</div>
                <div class="boost-price">100 ⭐</div>
                <div class="boost-desc">Увеличивает доход от кликов</div>
                <button class="boost-btn" data-price="100" data-multiplier="3">КУПИТЬ</button>
            </div>
            
            <div class="divider"></div>
            
            <div class="boost-card">
                <div class="boost-title">5X МНОЖИТЕЛЬ</div>
                <div class="boost-price">200 ⭐</div>
                <div class="boost-desc">Увеличивает доход от кликов</div>
                <button class="boost-btn" data-price="200" data-multiplier="5">КУПИТЬ</button>
            </div>
        </div>
        
        <!-- Друзья -->
        <div class="section" id="friends-section">
            <h1>ДРУЗЬЯ</h1>
            
            <div class="referral-card">
                <div class="referral-title">Приглашай друзей - Получай Награды!</div>
                <div class="referral-reward">Каждый приглашенный друг = +10 ⭐</div>
                
                <button class="invite-btn" id="invite-btn">Пригласить друга</button>
                
                <div class="referral-stats">Приглашенные друзья: <span id="referral-count">0</span></div>
            </div>
        </div>
        
        <!-- Профиль -->
        <div class="section" id="profile-section">
            <h1>ПРОФИЛЬ</h1>
            
            <div class="profile-info-container">
                <div class="profile-row">
                    <span class="profile-label">ID:</span>
                    <span class="profile-value" id="profile-id">123456</span>
                </div>
                <div class="profile-row">
                    <span class="profile-label">Никнейм:</span>
                    <span class="profile-value" id="profile-username">Игрок</span>
                </div>
                <div class="profile-row">
                    <span class="profile-label">Звезд:</span>
                    <span class="profile-value" id="profile-coins">0 ⭐</span>
                </div>
                <div class="profile-row">
                    <span class="profile-label">Буст:</span>
                    <span class="profile-value" id="profile-boost">Нет</span>
                </div>
                <div class="profile-row">
                    <span class="profile-label">Приглашено:</span>
                    <span class="profile-value" id="profile-referrals">0</span>
                </div>
                
                <button class="withdraw-btn-profile" id="profile-withdraw-btn">
                    Вывести звезды
                </button>
            </div>
        </div>
    </div>
    
    <!-- Подвал с меню -->
    <div class="footer">
        <div class="menu-container">
            <div class="menu-item active" data-section="clicker-section">
                <i class="fas fa-star"></i>
                <span>Кликер</span>
            </div>
            <div class="menu-item" data-section="boosts-section">
                <i class="fas fa-bolt"></i>
                <span>Бусты</span>
            </div>
            <div class="menu-item" data-section="friends-section">
                <i class="fas fa-users"></i>
                <span>Друзья</span>
            </div>
            <div class="menu-item" data-section="profile-section">
                <i class="fas fa-user"></i>
                <span>Профиль</span>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно вывода -->
    <div class="modal" id="withdraw-modal">
        <div class="modal-content">
            <div class="modal-title">ВЫВОД ЗВЕЗД</div>
            <div id="withdraw-content">
                <div class="withdraw-options">
                    <button class="withdraw-btn" data-amount="50">50 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="100">100 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="250">250 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="500">500 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="1000">1000 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="2500">2500 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="5000">5000 <span>⭐</span></button>
                    <button class="withdraw-btn" data-amount="10000">10000 <span>⭐</span></button>
                </div>
                <button class="close-modal" id="close-modal">ЗАКРЫТЬ</button>
            </div>
            <div id="no-coins-content" style="display: none;">
                <div class="no-coins">
                    <div class="no-coins-icon">
                        <i class="fas fa-star"></i>
                    </div>
                    <div class="no-coins-text">
                        У вас недостаточно звезд для вывода
                    </div>
                    <button class="close-modal" id="close-no-coins-modal">ЗАКРЫТЬ</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Модальное окно реферальной ссылки -->
    <div class="modal" id="referral-modal">
        <div class="modal-content">
            <div class="modal-title">Пригласить друга</div>
            <div class="referral-link" id="referral-link-text">https://example.com?ref=123456</div>
            <button class="copy-btn" id="copy-btn">СКОПИРОВАТЬ ССЫЛКУ</button>
            <button class="close-modal" id="close-referral-modal">ЗАКРЫТЬ</button>
        </div>
    </div>

    <script>
        // Удаляем зависимость от Telegram WebApp
        // const tg = window.Telegram.WebApp;
        // tg.expand();

        // Данные пользователя
        const userData = {
            id: 'user_' + Math.floor(Math.random() * 1000000).toString(),
            username: 'Игрок',
            coins: parseFloat(localStorage.getItem('starCoins')) || 0,
            boostMultiplier: 1,
            activeBoost: null,
            boostEndTime: 0,
            referrals: parseInt(localStorage.getItem('referralsCount')) || 0,
            referralCode: localStorage.getItem('referralCode') || generateReferralCode()
        };

        // Генерация реферального кода
        function generateReferralCode() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let result = '';
            for (let i = 0; i < 6; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            localStorage.setItem('referralCode', result);
            return result;
        }

        // Создание звезд на фоне
        function createStars() {
            const starCount = 50;
            const bgStarCount = 10;
            const constellationCount = 3;
            
            // Мелкие звезды переднего плана
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                
                // Случайные параметры
                const size = Math.random() * 3 + 1;
                const posX = Math.random() * 100;
                const duration = Math.random() * 15 + 10;
                const delay = Math.random() * 5;
                const opacity = Math.random() * 0.5 + 0.3;
                
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${posX}vw`;
                star.style.bottom = '0';
                star.style.animationDuration = `${duration}s`;
                star.style.animationDelay = `${delay}s`;
                star.style.opacity = opacity;
                
                document.body.appendChild(star);
            }
            
            // Большие звезды заднего плана
            for (let i = 0; i < bgStarCount; i++) {
                const star = document.createElement('div');
                star.className = 'star-bg';
                
                const size = Math.random() * 8 + 5;
                const posX = Math.random() * 100;
                const posY = Math.random() * 100;
                const duration = Math.random() * 120 + 60;
                const delay = Math.random() * 30;
                const opacity = Math.random() * 0.2 + 0.1;
                
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${posX}vw`;
                star.style.top = `${posY}vh`;
                star.style.animationDuration = `${duration}s`;
                star.style.animationDelay = `${delay}s`;
                star.style.opacity = opacity;
                
                document.body.appendChild(star);
            }
            
            // Вращающиеся созвездия
            for (let i = 0; i < constellationCount; i++) {
                const constellation = document.createElement('div');
                constellation.className = 'constellation';
                
                const posX = Math.random() * 100;
                const posY = Math.random() * 100;
                const duration = Math.random() * 300 + 200;
                const delay = Math.random() * 100;
                
                constellation.style.left = `${posX}vw`;
                constellation.style.top = `${posY}vh`;
                constellation.style.animationDuration = `${duration}s`;
                constellation.style.animationDelay = `${delay}s`;
                
                // Создаем звезды внутри созвездия
                const starsInside = Math.floor(Math.random() * 5) + 3;
                for (let j = 0; j < starsInside; j++) {
                    const star = document.createElement('div');
                    star.style.position = 'absolute';
                    star.style.width = `${Math.random() * 4 + 2}px`;
                    star.style.height = star.style.width;
                    star.style.backgroundColor = 'rgba(255, 255, 255, 0.7)';
                    star.style.borderRadius = '50%';
                    star.style.filter = 'blur(0.5px)';
                    
                    // Позиционируем звезды внутри созвездия
                    const angle = Math.random() * Math.PI * 2;
                    const distance = Math.random() * 60 + 20;
                    star.style.left = `calc(50% + ${Math.cos(angle) * distance}px)`;
                    star.style.top = `calc(50% + ${Math.sin(angle) * distance}px)`;
                    
                    constellation.appendChild(star);
                }
                
                document.body.appendChild(constellation);
            }
            
            // Создаем пульсирующие эффекты для глубины
            for (let i = 0; i < 2; i++) {
                const pulse = document.createElement('div');
                pulse.className = 'pulse-effect';
                
                const posX = Math.random() * 100;
                const posY = Math.random() * 100;
                const delay = Math.random() * 5;
                
                pulse.style.left = `${posX}vw`;
                pulse.style.top = `${posY}vh`;
                pulse.style.animationDelay = `${delay}s`;
                
                document.body.appendChild(pulse);
            }
        }

        // Эффект при клике на фон
        function setupBackgroundClickEffect() {
            const mainContent = document.getElementById('main-content');
            
            mainContent.addEventListener('click', function(e) {
                if (e.target === mainContent) {
                    // Эффект клика
                    const clickEffect = document.createElement('div');
                    clickEffect.className = 'click-effect';
                    clickEffect.style.left = `${e.clientX - 5}px`;
                    clickEffect.style.top = `${e.clientY - 5}px`;
                    
                    document.body.appendChild(clickEffect);
                    
                    // Запускаем анимацию
                    setTimeout(() => {
                        clickEffect.style.animation = 'clickEffect 0.6s ease-out forwards';
                    }, 10);
                    
                    // Удаляем элемент после анимации
                    setTimeout(() => {
                        clickEffect.remove();
                    }, 600);
                    
                    // Создаем дополнительные звезды при клике
                    for (let i = 0; i < 3; i++) {
                        const star = document.createElement('div');
                        star.className = 'star';
                        
                        const size = Math.random() * 2 + 1;
                        const duration = Math.random() * 5 + 3;
                        const opacity = Math.random() * 0.7 + 0.3;
                        
                        star.style.width = `${size}px`;
                        star.style.height = `${size}px`;
                        star.style.left = `${e.clientX + (Math.random() * 40 - 20)}px`;
                        star.style.top = `${e.clientY + (Math.random() * 40 - 20)}px`;
                        star.style.animationDuration = `${duration}s`;
                        star.style.opacity = opacity;
                        
                        document.body.appendChild(star);
                        
                        // Удаляем звезду после анимации
                        setTimeout(() => {
                            star.remove();
                        }, duration * 1000);
                    }
                }
            });
        }

        // Показ кастомного уведомления
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            
            document.body.appendChild(notification);
            
            // Удаляем уведомление после анимации
            setTimeout(() => {
                notification.remove();
            }, 2300);
        }

        // Элементы
        const clickerBtn = document.getElementById('clicker-btn');
        const coinsDisplay = document.getElementById('coins');
        const headerBalance = document.getElementById('header-balance');
        const headerUsername = document.getElementById('header-username');
        const balanceBtn = document.getElementById('balance-btn');
        const boostInfo = document.getElementById('boost-info');
        const profileId = document.getElementById('profile-id');
        const profileUsername = document.getElementById('profile-username');
        const profileCoins = document.getElementById('profile-coins');
        const profileBoost = document.getElementById('profile-boost');
        const profileReferrals = document.getElementById('profile-referrals');
        const inviteBtn = document.getElementById('invite-btn');
        const boostButtons = document.querySelectorAll('.boost-btn');
        const withdrawModal = document.getElementById('withdraw-modal');
        const closeModal = document.getElementById('close-modal');
        const withdrawBtns = document.querySelectorAll('.withdraw-btn');
        const menuItems = document.querySelectorAll('.menu-item');
        const sections = document.querySelectorAll('.section');
        const profileWithdrawBtn = document.getElementById('profile-withdraw-btn');
        const preloader = document.getElementById('preloader');
        const referralModal = document.getElementById('referral-modal');
        const referralLinkText = document.getElementById('referral-link-text');
        const copyBtn = document.getElementById('copy-btn');
        const closeReferralModal = document.getElementById('close-referral-modal');
        const referralCount = document.getElementById('referral-count');
        const withdrawContent = document.getElementById('withdraw-content');
        const noCoinsContent = document.getElementById('no-coins-content');
        const closeNoCoinsModal = document.getElementById('close-no-coins-modal');

        // Инициализация
        function init() {
            // Создаем звезды на фоне
            createStars();
            
            // Настраиваем эффект при клике на фон
            setupBackgroundClickEffect();
            
            // Скрываем все модальные окна
            withdrawModal.style.display = 'none';
            referralModal.style.display = 'none';
            
            // Установка данных пользователя
            headerUsername.textContent = userData.username;
            profileId.textContent = userData.id;
            profileUsername.textContent = userData.username;
            profileReferrals.textContent = userData.referrals;
            referralCount.textContent = userData.referrals;
            updateBalance();
            
            // Проверка активного буста
            checkActiveBoost();
            
            // Клик по звезде
            clickerBtn.addEventListener('click', () => {
                // Анимация
                clickerBtn.style.transform = 'scale(0.95)';
                setTimeout(() => clickerBtn.style.transform = 'scale(1)', 100);
                
                // Добавляем звезды
                userData.coins += 0.1 * userData.boostMultiplier;
                updateBalance();
                localStorage.setItem('starCoins', userData.coins);
                
                // Создаем эффект клика
                const clickEffect = document.createElement('div');
                clickEffect.className = 'click-effect';
                const rect = clickerBtn.getBoundingClientRect();
                clickEffect.style.left = `${rect.left + rect.width/2}px`;
                clickEffect.style.top = `${rect.top + rect.height/2}px`;
                
                document.body.appendChild(clickEffect);
                
                // Запускаем анимацию
                setTimeout(() => {
                    clickEffect.style.animation = 'clickEffect 0.6s ease-out forwards';
                }, 10);
                
                // Удаляем элемент после анимации
                setTimeout(() => {
                    clickEffect.remove();
                }, 600);
            });
            
            // Клик по балансу
            balanceBtn.addEventListener('click', () => {
                withdrawModal.style.display = 'flex';
                
                // Проверяем баланс и показываем соответствующее содержимое
                if (userData.coins >= 50) {
                    withdrawContent.style.display = 'block';
                    noCoinsContent.style.display = 'none';
                } else {
                    withdrawContent.style.display = 'none';
                    noCoinsContent.style.display = 'block';
                }
            });
            
            // Закрытие модального окна
            closeModal.addEventListener('click', () => {
                withdrawModal.style.display = 'none';
            });
            
            // Закрытие модального окна без звезд
            closeNoCoinsModal.addEventListener('click', () => {
                withdrawModal.style.display = 'none';
            });
            
            // Кнопки вывода
            withdrawBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const amount = parseInt(this.getAttribute('data-amount'));
                    if (userData.coins >= amount) {
                        userData.coins -= amount;
                        updateBalance();
                        localStorage.setItem('starCoins', userData.coins);
                        showNotification(`Выведено ${amount} ⭐`);
                        withdrawModal.style.display = 'none';
                    } else {
                        withdrawContent.style.display = 'none';
                        noCoinsContent.style.display = 'block';
                    }
                });
            });
            
            // Покупка бустов
            boostButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const price = parseInt(this.getAttribute('data-price'));
                    const multiplier = parseInt(this.getAttribute('data-multiplier'));
                    
                    if (userData.coins >= price) {
                        userData.coins -= price;
                        userData.boostMultiplier = multiplier;
                        userData.boostEndTime = Date.now() + 30000; // 30 секунд
                        
                        // Обновляем отображение
                        updateBalance();
                        updateBoostInfo();
                        this.disabled = true;
                        this.textContent = 'АКТИВЕН';
                        this.style.background = 'linear-gradient(45deg, #4CAF50, #8BC34A)';
                        
                        // Запускаем таймер
                        setTimeout(() => {
                            if (userData.boostMultiplier === multiplier) {
                                userData.boostMultiplier = 1;
                                updateBoostInfo();
                            }
                            this.disabled = false;
                            this.textContent = 'КУПИТЬ';
                            this.style.background = 'linear-gradient(45deg, #9C27B0, #E91E63)';
                        }, 30000);
                        
                        localStorage.setItem('starCoins', userData.coins);
                    } else {
                        showNotification('Недостаточно звезд!');
                    }
                });
            });
            
            // Скрытие прелоадера
            setTimeout(function() {
                preloader.style.opacity = '0';
                preloader.style.visibility = 'hidden';
            }, 2000);
            
            // Обработчик для кнопки вывода в профиле
            profileWithdrawBtn.addEventListener('click', function() {
                withdrawModal.style.display = 'flex';
                
                // Проверяем баланс и показываем соответствующее содержимое
                if (userData.coins >= 50) {
                    withdrawContent.style.display = 'block';
                    noCoinsContent.style.display = 'none';
                } else {
                    withdrawContent.style.display = 'none';
                    noCoinsContent.style.display = 'block';
                }
            });
            
            // Приглашение друзей
            inviteBtn.addEventListener('click', () => {
                const referralLink = `https://example.com?ref=${userData.referralCode}`;
                referralLinkText.textContent = referralLink;
                referralModal.style.display = 'flex';
            });
            
            // Копирование реферальной ссылки
            copyBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(referralLinkText.textContent).then(() => {
                    showNotification('Ссылка скопирована!');
                    referralModal.style.display = 'none';
                }).catch(err => {
                    console.error('Ошибка копирования: ', err);
                    // Альтернативный метод для браузеров без Clipboard API
                    const textarea = document.createElement('textarea');
                    textarea.value = referralLinkText.textContent;
                    document.body.appendChild(textarea);
                    textarea.select();
                    document.execCommand('copy');
                    document.body.removeChild(textarea);
                    showNotification('Ссылка скопирована!');
                    referralModal.style.display = 'none';
                });
            });
            
            // Закрытие модального окна реферальной ссылки
            closeReferralModal.addEventListener('click', () => {
                referralModal.style.display = 'none';
            });
            
            // Переключение разделов
            menuItems.forEach(item => {
                item.addEventListener('click', () => {
                    const sectionId = item.getAttribute('data-section');
                    
                    // Обновляем активный пункт меню
                    menuItems.forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                    
                    // Показываем только выбранный раздел
                    sections.forEach(section => section.classList.remove('active'));
                    document.getElementById(sectionId).classList.add('active');
                });
            });
        }
        
        // Обновление баланса
        function updateBalance() {
            const coins = userData.coins.toFixed(1);
            coinsDisplay.textContent = coins;
            headerBalance.textContent = coins;
            profileCoins.textContent = coins + ' ⭐';
            localStorage.setItem('starCoins', userData.coins);
        }
        
        // Обновление информации о бусте
        function updateBoostInfo() {
            if (userData.boostMultiplier > 1) {
                const timeLeft = Math.ceil((userData.boostEndTime - Date.now()) / 1000);
                if (timeLeft > 0) {
                    boostInfo.textContent = `Буст x${userData.boostMultiplier} (${timeLeft} сек)`;
                    profileBoost.textContent = `x${userData.boostMultiplier} (активен)`;
                } else {
                    boostInfo.textContent = 'Без буста';
                    profileBoost.textContent = 'Нет';
                }
            } else {
                boostInfo.textContent = 'Без буста';
                profileBoost.textContent = 'Нет';
            }
        }
        
        // Проверка активного буста
        function checkActiveBoost() {
            if (userData.boostEndTime > Date.now()) {
                const timeLeft = Math.ceil((userData.boostEndTime - Date.now()) / 1000);
                boostInfo.textContent = `Буст x${userData.boostMultiplier} (${timeLeft} сек)`;
                
                // Запускаем таймер
                const timer = setInterval(() => {
                    const timeLeft = Math.ceil((userData.boostEndTime - Date.now()) / 1000);
                    if (timeLeft <= 0) {
                        clearInterval(timer);
                        userData.boostMultiplier = 1;
                        updateBoostInfo();
                        
                        // Восстанавливаем кнопки бустов
                        boostButtons.forEach(btn => {
                            if (btn.disabled) {
                                btn.disabled = false;
                                btn.textContent = 'КУПИТЬ';
                                btn.style.background = 'linear-gradient(45deg, #9C27B0, #E91E63)';
                            }
                        });
                    } else {
                        boostInfo.textContent = `Буст x${userData.boostMultiplier} (${timeLeft} сек)`;
                    }
                }, 1000);
            } else {
                updateBoostInfo();
            }
        }
        
        // Запуск
        init();
    </script>
</body>
</html>
